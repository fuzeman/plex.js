!function(e,t){"function"==typeof define&&define.amd?define(["httpinvoke","ua-parser","when"],t):e.plex=t(e.httpinvoke,e.UAParser,e.when)}(this,function(e,t,n){var r,i,o;return function(e){function t(e,t){return g.call(e,t)}function n(e,t){var n,r,i,o,s,u,c,l,p,f,a,d=t&&t.split("/"),h=m.map,x=h&&h["*"]||{};if(e&&"."===e.charAt(0))if(t){for(d=d.slice(0,d.length-1),e=e.split("/"),s=e.length-1,m.nodeIdCompat&&P.test(e[s])&&(e[s]=e[s].replace(P,"")),e=d.concat(e),p=0;p<e.length;p+=1)if(a=e[p],"."===a)e.splice(p,1),p-=1;else if(".."===a){if(1===p&&(".."===e[2]||".."===e[0]))break;p>0&&(e.splice(p-1,2),p-=2)}e=e.join("/")}else 0===e.indexOf("./")&&(e=e.substring(2));if((d||x)&&h){for(n=e.split("/"),p=n.length;p>0;p-=1){if(r=n.slice(0,p).join("/"),d)for(f=d.length;f>0;f-=1)if(i=h[d.slice(0,f).join("/")],i&&(i=i[r])){o=i,u=p;break}if(o)break;!c&&x&&x[r]&&(c=x[r],l=p)}!o&&c&&(o=c,u=l),o&&(n.splice(0,u,o),e=n.join("/"))}return e}function s(t,n){return function(){return d.apply(e,$.call(arguments,0).concat([t,n]))}}function u(e){return function(t){return n(t,e)}}function c(e){return function(t){y[e]=t}}function l(n){if(t(_,n)){var r=_[n];delete _[n],v[n]=!0,a.apply(e,r)}if(!t(y,n)&&!t(v,n))throw new Error("No "+n);return y[n]}function p(e){var t,n=e?e.indexOf("!"):-1;return n>-1&&(t=e.substring(0,n),e=e.substring(n+1,e.length)),[t,e]}function f(e){return function(){return m&&m.config&&m.config[e]||{}}}var a,d,h,x,y={},_={},m={},v={},g=Object.prototype.hasOwnProperty,$=[].slice,P=/\.js$/;h=function(e,t){var r,i=p(e),o=i[0];return e=i[1],o&&(o=n(o,t),r=l(o)),o?e=r&&r.normalize?r.normalize(e,u(t)):n(e,t):(e=n(e,t),i=p(e),o=i[0],e=i[1],o&&(r=l(o))),{f:o?o+"!"+e:e,n:e,pr:o,p:r}},x={require:function(e){return s(e)},exports:function(e){var t=y[e];return"undefined"!=typeof t?t:y[e]={}},module:function(e){return{id:e,uri:"",exports:y[e],config:f(e)}}},a=function(n,r,i,o){var u,p,f,a,d,m,g=[],$=typeof i;if(o=o||n,"undefined"===$||"function"===$){for(r=!r.length&&i.length?["require","exports","module"]:r,d=0;d<r.length;d+=1)if(a=h(r[d],o),p=a.f,"require"===p)g[d]=x.require(n);else if("exports"===p)g[d]=x.exports(n),m=!0;else if("module"===p)u=g[d]=x.module(n);else if(t(y,p)||t(_,p)||t(v,p))g[d]=l(p);else{if(!a.p)throw new Error(n+" missing "+p);a.p.load(a.n,s(o,!0),c(p),{}),g[d]=y[p]}f=i?i.apply(y[n],g):void 0,n&&(u&&u.exports!==e&&u.exports!==y[n]?y[n]=u.exports:f===e&&m||(y[n]=f))}else n&&(y[n]=i)},r=i=d=function(t,n,r,i,o){if("string"==typeof t)return x[t]?x[t](n):l(h(t,n).f);if(!t.splice){if(m=t,m.deps&&d(m.deps,m.callback),!n)return;n.splice?(t=n,n=r,r=null):t=e}return n=n||function(){},"function"==typeof r&&(r=i,i=o),i?a(e,t,n,r):setTimeout(function(){a(e,t,n,r)},4),d},d.config=function(e){return d(e)},r._defined=y,o=function(e,n,r){n.splice||(r=n,n=[]),t(y,e)||t(_,e)||(_[e]=[e,n,r])},o.amd={jQuery:!0}}(),o("../../../../bower_components/almond/almond.js",function(){}),o("plex/core/utils",[],function(){var e={random:{string:function(t,n){t=e.isDefined(t)?t:16,n=e.isDefined(n)?n:"0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(var r="",i=t;i>0;--i)r+=n[Math.round(Math.random()*(n.length-1))];return r}},url:{query:{encode:function(t){if(!e.isDefined(t))return"";var n=[];for(var r in t)t.hasOwnProperty(r)&&n.push(encodeURIComponent(r)+"="+encodeURIComponent(t[r]));return n.join("&")}},encode:function(t,n){var r=e.url.query.encode(n);return 0===r.length?t:t+"?"+r}},clone:function(t){if(null===t||"object"!=typeof t)return t;var n=t.constructor();for(var r in t)t.hasOwnProperty(r)&&(n[r]=e.clone(t[r]));return n},isDefined:function(e){return!("undefined"==typeof e||null===e)}};return e}),o("plex/core/headers",["plex/core/utils","ua-parser"],function(e,t){function n(){var e=new t,n=e.getBrowser(),r=e.getOS();return{"X-Plex-Device":r.name,"X-Plex-Device-Name":null,"X-Plex-Platform":n.name,"X-Plex-Platform-Version":n.version.substr(0,n.version.indexOf(".",3)),"X-Plex-Product":"plex.js","X-Plex-Version":"1.0.0"}}function r(){this["default"]=n(),this.current=e.clone(this["default"])}return r.prototype.get=function(t){t="undefined"!=typeof t?t:{};var n=e.clone(this.current);null===n["X-Plex-Device-Name"]&&(null!==n["X-Plex-Product"]&&null!==n["X-Plex-Platform"]?n["X-Plex-Device-Name"]=n["X-Plex-Product"]+" ("+n["X-Plex-Platform"]+")":null!==n["X-Plex-Product"]?n["X-Plex-Device-Name"]=n["X-Plex-Product"]:n["X-Plex-Device-Name"]="plex.js");for(var r in t)t.hasOwnProperty(r)&&(n[r]=t[r]);return n},r.prototype.update=function(e){for(var t in e)e.hasOwnProperty(t)&&(this.current[t]=e[t])},r.prototype.reset=function(){this.current=e.clone(this["default"])},r.prototype.setDevice=function(e,t){this.update({"X-Plex-Device":t,"X-Plex-Device-Name":e})},r.prototype.setPlatform=function(e,t){this.update({"X-Plex-Platform":e,"X-Plex-Platform-Version":t})},r.prototype.setProduct=function(e,t){this.update({"X-Plex-Product":e,"X-Plex-Version":t})},r}),o("plex/core/interface_registry",["plex/core/utils"],function(e){function t(){this.interfaces={}}return t.prototype.set=function(t){var n=t.__path__;if("undefined"==typeof n||null===n)throw new Error('Interface is missing a "__path__" attribute',t);if(e.isDefined(this.interfaces[n]))throw new Error('Interface "'+n+'" already registered');this.interfaces[n]=t,console.debug('Registered interface "%s"',n)},t.prototype.expose=function(e){for(var t in this.interfaces)this.interfaces.hasOwnProperty(t)&&(e[t]=new this.interfaces[t](e),console.debug('Exposed interface "%s"',t))},t.prototype.exposeRoot=function(t){var n=t[""];if(e.isDefined(n))for(var r in n)if(0!==r.indexOf("$")&&!n.hasOwnProperty(r)){if(e.isDefined(t[r]))throw new Error('Method proxy "'+r+'" already exists');t[r]=function(e){return function(){return e.apply(n,arguments)}}(n[r]),console.debug('Exposed root method "%s"',r)}},t}),o("plex/cloud/interfaces/registry",["plex/core/interface_registry"],function(e){return new e}),o("plex/cloud/interfaces/api/home/root",["plex/cloud/interfaces/registry"],function(e){function t(e){this.$c=e}t.prototype.$r=function(e,n,r){return r="undefined"!=typeof r?r:{},r.outputType="xml",this.$c.request(e,t.__path__+"/"+n,r)},t.prototype.users=function(){return this.$r("GET","users")},t.__path__="/api/home",e.set(t)}),o("plex/cloud/interfaces/api/home/users",["plex/cloud/interfaces/registry","plex/core/utils"],function(e,t){function n(e){this.$c=e}n.prototype.$r=function(e,t,r){return r="undefined"!=typeof r?r:{},r.outputType="xml",this.$c.request(e,n.__path__+"/"+t,r)},n.prototype["switch"]=function(e,n){if(!t.isDefined(e))throw new Error;var r={};return t.isDefined(n)&&(r.pin=n),this.$r("POST",t.url.encode(e+"/switch",r))},n.__path__="/api/home/users",e.set(n)}),o("plex/cloud/interfaces/api/invites",["plex/cloud/interfaces/registry"],function(e){function t(e){this.$c=e}t.prototype.$r=function(e,n,r){return r="undefined"!=typeof r?r:{},r.outputType="xml",this.$c.request(e,t.__path__+"/"+n,r)},t.prototype.requested=function(){return this.$r("GET","requested")},t.prototype.requests=function(){return this.$r("GET","requests")},t.__path__="/api/invites",e.set(t)}),o("plex/cloud/interfaces/api/root",["plex/cloud/interfaces/registry","plex/core/utils"],function(e,t){function n(e){this.$c=e}n.prototype.$r=function(e,t,r){return r="undefined"!=typeof r?r:{},r.outputType="xml",this.$c.request(e,n.__path__+"/"+t,r)},n.prototype.home=function(){return this.$r("GET","home")},n.prototype.resources=function(e){var n={};return t.isDefined(e)&&("boolean"==typeof e&&(e=e?1:0),n.includeHttps=e),this.$r("GET",t.url.encode("resources",n))},n.prototype.users=function(){return this.$r("GET","users")},n.__path__="/api",e.set(n)}),o("plex/cloud/interfaces/pms/main",["plex/cloud/interfaces/registry"],function(e){function t(e){this.$c=e}t.prototype.$r=function(e,n,r){return this.$c.request(e,t.__path__+"/"+n,r)},t.prototype.ip=function(){return this.$r("GET","ip")},t.__path__="/pms/:",e.set(t)}),o("plex/cloud/interfaces/pms/playlists",["plex/cloud/interfaces/registry"],function(e){function t(e){this.$c=e}t.prototype.$r=function(e,n,r){return r="undefined"!=typeof r?r:{},r.outputType="xml",this.$c.request(e,t.__path__+"/"+n,r)},t.prototype.all=function(e){return this.$r("GET",e+"/all")},t.prototype.unwatched=function(e){return this.$r("GET",e+"/unwatched")},t.prototype.deleteItem=function(e,t){return this.$r("DELETE",e+"/items/"+t)},t.__path__="/pms/playlists",e.set(t)}),o("plex/cloud/interfaces/pms/social",["plex/cloud/interfaces/registry"],function(e){function t(e){this.$c=e}t.prototype.$r=function(e,n,r){return r="undefined"!=typeof r?r:{},r.outputType="xml",this.$c.request(e,t.__path__+"/"+n,r)},t.prototype.networks=function(){return this.$r("GET","networks")},t.__path__="/pms/social",e.set(t)}),o("plex/cloud/interfaces/devices",["plex/cloud/interfaces/registry"],function(e){function t(e){this.$c=e}t.prototype.$r=function(e,n,r){return r="undefined"!=typeof r?r:{},r.outputType="xml",this.$c.request(e,t.__path__+"/"+n,r)},t.prototype["delete"]=function(e){return this.$r("DELETE",e+".xml")},t.__path__="/devices",e.set(t)}),o("plex/cloud/interfaces/main",["plex/cloud/interfaces/registry","plex/core/utils"],function(e,t){function n(e){this.$c=e}n.prototype.$r=function(e,t,r){return r="undefined"!=typeof r?r:{},r.outputType="xml",this.$c.request(e,n.__path__+"/"+t,r)},n.prototype.scrobble=function(e,n){if(!t.isDefined(e)||!t.isDefined(n))throw new Error;return this.$r("GET",t.url.encode("scrobble",{key:e,identifier:n}))},n.prototype.unscrobble=function(e,n){if(!t.isDefined(e)||!t.isDefined(n))throw new Error;return this.$r("GET",t.url.encode("unscrobble",{key:e,identifier:n}))},n.__path__="/:",e.set(n)}),o("plex/cloud/interfaces/pins",["plex/cloud/interfaces/registry"],function(e){function t(e){this.$c=e}t.prototype.$r=function(e,n,r){return r="undefined"!=typeof r?r:{},r.outputType="xml",this.$c.request(e,t.__path__+"/"+n,r)},t.prototype.get=function(e){return this.$r("GET",e+".xml")},t.__path__="/pins",e.set(t)}),o("plex/cloud/interfaces/root",["plex/cloud/interfaces/registry"],function(e){function t(e){this.$c=e}t.prototype.$r=function(e,n,r){return r="undefined"!=typeof r?r:{},r.outputType="xml",this.$c.request(e,t.__path__+"/"+n,r)},t.prototype.devices=function(){return this.$r("GET","devices.xml")},t.prototype.pins=function(){return this.$r("POST","pins.xml")},t.__path__="",e.set(t)}),o("plex/cloud/interfaces/users",["plex/cloud/interfaces/registry","plex/core/utils"],function(e,t){function n(e){this.$c=e}n.prototype.$r=function(e,t,r){return r="undefined"!=typeof r?r:{},r.outputType="xml",this.$c.request(e,n.__path__+"/"+t,r)},n.prototype.account=function(){return this.$r("GET","account")},n.prototype.login=function(e,n){if(!t.isDefined(e)||!t.isDefined(n))throw new Error;return this.$r("POST","sign_in.xml",{headers:{Authorization:"Basic "+btoa(e+":"+n)}})},n.__path__="/users",e.set(n)}),o("plex/cloud/main",["plex/core/headers","plex/cloud/interfaces/registry","httpinvoke","when","plex/cloud/interfaces/api/home/root","plex/cloud/interfaces/api/home/users","plex/cloud/interfaces/api/invites","plex/cloud/interfaces/api/root","plex/cloud/interfaces/pms/main","plex/cloud/interfaces/pms/playlists","plex/cloud/interfaces/pms/social","plex/cloud/interfaces/devices","plex/cloud/interfaces/main","plex/cloud/interfaces/pins","plex/cloud/interfaces/root","plex/cloud/interfaces/users"],function(e,t,n,r){function i(){this.baseUrl="https://plex.tv",this.headers=new e,this.client_identifier=null,this.token=null,t.expose(this),t.exposeRoot(this)}return i.prototype.request=function(e,t,i){var o=this.baseUrl+t,s=r.defer();return i="undefined"!=typeof i?i:{},i.converters={"xml text":function(e){var t=new XMLSerializer;return t.serializeToString(e)},"text xml":function(e){var t=new DOMParser;return t.parseFromString(e,"text/xml")}},i.headers=this.headers.get(i.headers),null!==this.client_identifier&&(i.headers["X-Plex-Client-Identifier"]=this.client_identifier),null!==this.token&&(i.headers["X-Plex-Token"]=this.token),n(o,e,i).then(function(e){e.statusCode>=200&&e.statusCode<=299?s.resolve(e.body):s.reject(e.body,e.statusCode,e.headers,null,e.statusText)},function(e){s.reject(null,null,null,null,e)}),s.promise},i}),o("plex/server/interfaces/registry",["plex/core/interface_registry"],function(e){return new e}),o("plex/server/interfaces/root",["plex/server/interfaces/registry"],function(e){function t(e){this.$c=e}t.prototype.$r=function(e,n,r){return r="undefined"!=typeof r?r:{},r.outputType="xml",this.$c.request(e,t.__path__+"/"+n,r)},t.prototype.details=function(){return this.$r("GET","")},t.prototype.identity=function(){return this.$r("GET","identity")},t.__path__="",e.set(t)}),o("plex/server/main",["plex/core/headers","plex/server/interfaces/registry","httpinvoke","when","plex/server/interfaces/root"],function(e,t,n,r){function i(n){this.baseUrl=n,this.headers=new e,this.client_identifier=null,this.token=null,t.expose(this),t.exposeRoot(this)}return i.prototype.request=function(e,t,i){var o=this.baseUrl+t,s=r.defer();return i="undefined"!=typeof i?i:{},i.converters={"xml text":function(e){var t=new XMLSerializer;return t.serializeToString(e)},"text xml":function(e){var t=new DOMParser;return t.parseFromString(e,"text/xml")}},i.headers=this.headers.get(i.headers),null!==this.client_identifier&&(i.headers["X-Plex-Client-Identifier"]=this.client_identifier),null!==this.token&&(i.headers["X-Plex-Token"]=this.token),n(o,e,i).then(function(e){e.statusCode>=200&&e.statusCode<=299?s.resolve(e.body):s.reject(e.body,e.statusCode,e.headers,null,e.statusText)},function(e){s.reject(null,null,null,null,e)}),s.promise},i}),o("plex/main",["plex/cloud/main","plex/server/main"],function(e,t){return{Cloud:e,Server:t,cloud:new e}}),o("plex",["plex/main"],function(e){return console.log("plex initialized"),e}),o("httpinvoke",function(){return e}),o("ua-parser",function(){return t}),o("when",function(){return n}),i("plex")});
//# sourceMappingURL=plex.js.map